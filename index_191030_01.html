<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Tendo</title>
</head>
	<link rel="stylesheet" type="text/css" href="css/index.css">
	<link href="https://fonts.googleapis.com/css?family=Roboto&display=swap" rel="stylesheet">
	<script src="js/TweenMax.js"></script>
	<script src="js/jquery-3.4.1.js"></script>
	<script src="js/ScrollMagic.js"></script>
	<script src="js/plugins/animation.gsap.js"></script>
	<script src="js/plugins/debug.addIndicators.js"></script>
	<script src="js/pixi.min.js"></script>
<body>
	
	<div class="container">
		
		<script>
			// init controller
			var controller = new ScrollMagic.Controller();
		</script>
		
		<script>
		
			var appbg = new PIXI.Application({ transparent: true });
			document.body.appendChild(appbg.view);
			appbg.renderer.view.style.position = "fixed";
			appbg.renderer.view.style.top = 0;
			appbg.renderer.view.style.left = 0;
			appbg.renderer.autoResize = true;
			appbg.renderer.resize(window.innerWidth, window.innerHeight);

			var cursor = new PIXI.Graphics();
			cursor.lineStyle(1, 0x000000, 2);
			cursor.drawCircle(0,0,25);
			appbg.stage.addChild(cursor);
			
			//get mouse position
			var getMousePositionBg = () =>
			{
				return appbg.renderer.plugins.interaction.mouse.global
			};
				
			let mousePositionBg = getMousePositionBg();
			
			appbg.ticker.add(() =>	{
				mousePositionBg = getMousePositionBg();
				cursor.x = mousePositionBg.x;
				cursor.y = mousePositionBg.y;
			});
		
		</script>
		
		<div id="trigger"></div>
		
		<script>
			
			var canvas = document.getElementById("myCanvas");
			
			var app = new PIXI.Application({ transparent: true });
			document.body.appendChild(app.view);
			app.renderer.view.style.display = "block";
			app.renderer.view.style.position = "absolute";
			app.renderer.view.style.margin = "auto";
			app.renderer.autoResize = true;
			app.renderer.resize(window.innerWidth, window.innerHeight);

			app.loader
				.add('js/EscherStar3D.json')
				.load(onAssetsLoaded);

			function onAssetsLoaded() {
				// create an array of textures from an image path
				const frames = [];

			for (let i = 1; i < 97; i++) {
					const val = i < 10 ? `0${i}` : i;

					// magically works since the spritesheet was loaded with the pixi loader
					frames.push(PIXI.Texture.from(`EscherStar3D.00${val}.png`));
				}

				// create an AnimatedSprite (brings back memories from the days of Flash, right ?)
				const anim = new PIXI.AnimatedSprite(frames);

				/*
				 * An AnimatedSprite inherits all the properties of a PIXI sprite
				 * so you can change its position, its anchor, mask it, etc
				 */
				anim.anchor.set(0.5);
				anim.animationSpeed = 0.5;
				anim.play();
			
			// Text
			
			var stlF = new PIXI.TextStyle({
				fontFamily: 'Arial',
				fontSize: anim.height / 10,
				fontWeight: 'bold',
				fill: 'black',
			});
			
			var stlS = new PIXI.TextStyle({
				fontFamily: 'Arial',
				fontSize: anim.height / 10 * 0.85,
				fontWeight: 'bold',
				fill: 'transparent',
				stroke: 'black',
				strokeThickness: 1,
			});
			
			var richText = new PIXI.Text('WEB', stlF);
			var richText2 = new PIXI.Text('ウェブ', stlS);
			var line2f = new PIXI.Text('MOTION', stlF);
			var line2s = new PIXI.Text('モーション', stlS);
			var line5f = new PIXI.Text('STORY', stlF);
			var line5s = new PIXI.Text('ストーリー', stlS);
			var line3f = new PIXI.Text('INTERACT', stlF);
			var line3s = new PIXI.Text('インタラク', stlS);
			var line4f = new PIXI.Text('DESIGN', stlF);
			var line4s = new PIXI.Text('デザイン', stlS);
			
			richText2.anchor.set(1,0.5);
			richText.anchor.set(0,0.5);
			line2f.anchor.set(1,0.5);
			line2s.anchor.set(0,0.5);
			line3s.anchor.set(1,0.5);
			line3f.anchor.set(0,0.5);
			line4f.anchor.set(1,0.5);
			line4s.anchor.set(0,0.5);
			line5s.anchor.set(1,0.5);
			line5f.anchor.set(0,0.5);
				
			var txtfrnt = new PIXI.Container();
				
			var txtbck = new PIXI.Container();
			
			//get mouse position
			var getMousePosition = () =>
			{
				return app.renderer.plugins.interaction.mouse.global
			};
				
			//magicScroll scene
			
			//rotation
			app.ticker.add(() => {
				
				var valScroll = {value: 0, distancehover: 0};
				
				mousePosition = getMousePosition();
				let scrnx = app.screen.width;
				let scrny = app.screen.height;
				let cx = mousePosition.x - scrnx / 2 ;
				let cy = mousePosition.y - scrny / 2 ;
				let distance = Math.sqrt(Math.pow(Math.abs(cx), 2) + Math.pow(Math.abs(cy), 2));
				let scrnrad = Math.sqrt(Math.pow(scrny / 2, 2) + Math.pow(scrnx / 2, 2));
				let drx = Math.abs(distance / scrnrad);
				let drxinv = Math.pow(1 - drx,2);
				let drxincr = drx + 1;
				
				console.log(drxinv);
				
				anim.x = - cx * 0.005 + scrnx / 2;
				anim.y = - cy * 0.005 + scrny / 2;
				anim.scale.x = 0.8 + drxinv * 0.1;
				anim.scale.y = 0.8 + drxinv * 0.1;
				
				richText2.y = - drxinv * scrny / 8 - anim.height / 6 * 1.6;
				richText.y =  - drxinv * scrny / 8 - anim.height / 6 * 1.6;
				
				line2f.x = - drxinv * scrnrad / 8;
				line2f.y = - drxinv * scrnrad / 16 - anim.height / 6 * 0.8;
				line2s.x = drxinv * scrnrad / 8;
				line2s.y = - drxinv * scrnrad / 16 - anim.height / 6 * 0.8;
				
				line3s.x = - drxinv * scrnx / 8;
				line3f.x = drxinv * scrnx / 8;
				
				
				line4f.x = - drxinv * scrnrad / 8;
				line4f.y = drxinv * scrnrad / 16 + anim.height / 6 * 0.8;
				line4s.x = drxinv * scrnrad / 8;
				line4s.y = drxinv * scrnrad / 16 + anim.height / 6 * 0.8;

				line5s.y = drxinv * scrny / 8 + anim.height / 6 * 1.6;
				line5f.y = drxinv * scrny / 8 + anim.height / 6 * 1.6;
				
				txtfrnt.y = scrny / 2 + valScroll.value - mousePosition.y / scrnx * 50;
				txtbck.y = scrny / 2 + valScroll.value * 1.1 + mousePosition.y / scrnx * 50;
				txtfrnt.x = scrnx / 2 - mousePosition.x / scrnx * 50;
				txtbck.x = scrnx / 2 + mousePosition.x / scrnx * 50;
				
			});
			
			txtfrnt.addChild(richText2);
			txtfrnt.addChild(line2s);
			txtfrnt.addChild(line3s);
			txtfrnt.addChild(line4s);
			txtfrnt.addChild(line5s);
			txtbck.addChild(richText);
			txtbck.addChild(line2f);
			txtbck.addChild(line3f);
			txtbck.addChild(line4f);
			txtbck.addChild(line5f);
				
			app.stage.addChild(txtfrnt);
			app.stage.addChild(anim);
			app.stage.addChild(txtbck);
			}
			
			// build scene
			
			var scene2 = new ScrollMagic.Scene({triggerElemetn: "#trigger", duration: window.innerHeight})
							.setTween(TweenMax.to(valScroll, 1, {value: -window.innerHeight}))
							.addIndicators({name: "2 - change inline style"}) // add indicators (requires plugin)
							.addTo(controller);
			
		</script>
		
	</div>
	
	<div class="container" style="height: 100vh; width: 100vw; padding: 20px; z-index: -1;"><div style="background: #eee; width: 100%; height: 100%;"></div></div>
	
	<div class="container section">
		
		<div class="cl-5" style="text-align: right;">
			
			<h2>WHO</h2>
			
		</div>
		
		<div class="cl-7 text-stroke"><h2>
			
			AM I?
			
		</h2></div>
	
		<div class="cl-5"></div>
			
		<h3 class="cl-7">NARRATIVE</h3>
		
		<div class="cl-6"></div>
	
		<div class="cl-6 padding-15">
			
			<span class="text-jp"><span class="text-large">私には「デザイン」はまるで「絵で本を書く」のようだ。</span></span><br>
			
			<span class="text-large">I define "design" as "writing a book using images".</span>
			
		</div>
	
		<div class="cl-5"></div>
			
		<h3 class="cl-7">CURIOUS</h3>
		
		<div class="cl-6"></div>
	
		<div class="cl-6 padding-15">
			
			<span class="text-jp"><span class="text-large">効果があるのか、実際にやらなければ分からない。</span></span><br>
			
			<span class="text-large">I have no idea if this is going to work or not, the only way to know is to actually doing it.</span>
			
		</div>
	
		<div class="cl-5"></div>
			
		<h3 class="cl-7">FORWARD</h3>
		
		<div class="cl-6"></div>
	
		<div class="cl-6 padding-15">
			
			<span class="text-jp"><span class="text-large">失敗しまった時は、悔やまずもう一歩進むべきだ。</span></span><br>
			
			<span class="text-large">if I ever have time to cry over my own failure, I would rather use said times to move one step forward.</span>
			
		</div>
			
	</div>
	
</body>
</html>
